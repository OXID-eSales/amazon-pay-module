window.OSCAmazonPayButtonComponent = {
    amazonPayButton:null,
    payLoad:null,
    signature:null,
    init:function(n, o, e) {
        this.amazonPayButton = n,
            this.payloadJSON = o,
            this.signature = e,
            this.registerEvents()
    },
    registerEvents:function() {
        amazonPayButton.onClick(function() {
            OSCAmazonPayButtonComponent.payButtonClickHandler()
        })
    },
    payButtonClickHandler:function() {
        this.forceConfirmAGB() &&
        !OSCAmazonPayCheckoutAGBComponent.isAgbConfirmed() ||
        this.forceConfirmDPA() &&
        !OSCAmazonPayCheckoutAGBComponent.isDpaConfirmed() ||
        this.forceConfirmSPA() &&
        !OSCAmazonPayCheckoutAGBComponent.isSpaConfirmed() ?
            (this.forceConfirmAGB() || this.forceConfirmDPA() || this.forceConfirmSPA()) &&
            (document.getElementById("confirm-agb-error-container").css("display","block"),
                    document.getElementByClassName("agbConfirmation").addClass("alert-danger")
            ): this.amazonPayButton.initCheckout({
            createCheckoutSessionConfig: {
                payloadJSON:this.payloadJSON,
                signature:this.signature
            }
        })
    },
    hideErrorContainer:function() {
        document.getElementById("confirm-agb-error-container").css("display","none")
    },
    forceConfirmAGB:function() {
        return document.getElementById("confirm-agb-error-container").dataset.oxidAgbForceConfirm
    },
    forceConfirmDPA:function() {
        return document.getElementById("confirm-agb-error-container").dataset.oxidDpaForceConfirm
    },
    forceConfirmSPA:function() {
        return document.getElementById("confirm-agb-error-container").dataset.oxidSpaForceConfirm
    }
},
window.OSCAmazonPayCheckoutAGBComponent = {
    init:function() {
        this.registerEvents()
    },
    registerEvents:function() {
        OSCAmazonPayButtonComponent.forceConfirmAGB() &&
        document.getElementById("checkAgbTop").on("click",function() {
            document.getElementByClassName("agbConfirmation").removeClass("alert-danger"),
                OSCAmazonPayButtonComponent.hideErrorContainer(),
                OSCAmazonPayCheckoutAGBComponent.saveAGBConfirmInSession()
        }),
        OSCAmazonPayButtonComponent.forceConfirmDPA() &&
        document.getElementById("oxdownloadableproductsagreement").on("click",function() {
            document.getElementByClassName("agbConfirmation").removeClass("alert-danger"),
                OSCAmazonPayButtonComponent.hideErrorContainer(),
                OSCAmazonPayCheckoutAGBComponent.saveDpaConfirmInSession()
        }),
        OSCAmazonPayButtonComponent.forceConfirmSPA() &&
        document.getElementById("oxserviceproductsagreement").on("click",function() {
            document.getElementByClassName("agbConfirmation").removeClass("alert-danger"),
                OSCAmazonPayButtonComponent.hideErrorContainer(),
                OSCAmazonPayCheckoutAGBComponent.saveSpaConfirmInSession()
        })
    },
    isAgbConfirmed:function() {
        return document.getElementById("checkAgbTop").is(":checked")
    },
    isDpaConfirmed:function() {
        return document.getElementById("oxdownloadableproductsagreement").is(":checked")
    },
    isSpaConfirmed:function() {
        return document.getElementById("oxserviceproductsagreement").is(":checked")
    },
    saveAGBConfirmInSession() {
        document.querySelector.ajax({
            type:"POST",
            url:"/index.php?cl=amazoncheckoutajax&fnc=confirmAGB",
            data:{
                confirm:this.isAgbConfirmed() ? 1 : 0
            }
        })
    },
    saveDpaConfirmInSession() {
        document.querySelector.ajax({
            type:"POST",
            url:"/index.php?cl=amazoncheckoutajax&fnc=confirmDPA",
            data:{
                confirm:this.isDpaConfirmed() ? 1 : 0
            }
        })
    },
    saveSpaConfirmInSession(){
        document.querySelector.ajax({
            type:"POST",
            url:"/index.php?cl=amazoncheckoutajax&fnc=confirmSPA",
            data:{
                confirm:this.isSpaConfirmed() ? 1 : 0
            }
        })
    }
};